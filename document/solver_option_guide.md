# Solver Option Guide

## How to Set Solver Option
The options of the cppmh solver can be set by a `cppmh::solver::Option` object. The following code shows an example of setting the options `verbose` and `tabu_search.iteration_max` to  `Full` and 10000, respectively.
```c++
cppmh::model::IPModel model;

/// The modeling code is omitted.

cppmh::solver::Option option;
option.verbose = cppmh::solver::Full;
option.tabu_search.iteration_max = 10000;

/// The option object is set as the 2nd argument of cppmh::solver::solve().
auto result = cppmh::solver::solve(&model, option);

```

## List of Options
### Global Options

| Name                                      |                        Type                        |               Default               | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|:------------------------------------------|:--------------------------------------------------:|:-----------------------------------:|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `iteration_max`                           |                       `int`                        |                `100`                | Allowed maximum number of outer loop iterations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `time_max`                                |                      `double`                      |                `120`                | Allowed maximum computational time for optimization calculation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `penalty_coefficient_relaxing_rate`       |                      `double`                      |                `0.9`                | If the augmented objective incumbent obtained by a tabu search is feasible, all penalty coefficients will be relaxed by the multiplying `penalty_coefficient_relaxing_rate`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `penalty_coefficient_relaxing_rate`       |                      `double`                      |                `1.0`                | If the augmented objective incumbent obtained by a tabu search is not feasible, penalty coefficients corresponding violative constraints will be tightened by the adding violation multiplied by `penalty_coefficient_relaxing_rate`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `initial_penalty_coefficient`             |                      `double`                      |                `1E7`                | Initial penalty coefficient value. The penalty coefficients corresponding to all constraints are initialized by `initial_penalty_coefficient`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `is_enabled_lagrange_dual`                |                       `bool`                       |               `false`               | If this option is set `true`, an initial solution will be prepared by solving a lagrange dual problem by a subgradient method.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `is_enabled_local_search`                 |                       `bool`                       |               `false`               | If this option is set `true`, the initial solution will be improved by a naive local search employing first-admissible move strategy.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `is_enabled_grouping_penalty_coefficient` |                       `bool`                       |               `false`               | If this option is set `true`, the penalty coefficients for constraints belonging to the same constraint group are aligned to the largest one in the group. Here, "constraint groups" are constraints which share common symbol and are distinguished by their indices.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `is_enabled_presolve`                     |                       `bool`                       |               `true`                | If this option is set `true`, cppmh tries to fix decision variables and to remove redundant constraints as a presolve.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `is_enabled_initial_value_correction`     |                       `bool`                       |               `true`                | If this option is set `true`, cppmh tries to correct initial value of decision variables necessarily so that they satisfy ther lower and upper bounds and so on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `is_enabled_parallel_evaluation`          |                       `bool`                       |               `true`                | If this option is set `true`, evaluations of neighborhood solutions will be parallelized using [OpenMP](https://www.openmp.org).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `is_enabled_parallel_neighborhood_update` |                       `bool`                       |               `true`                | If this option is set `true`, updating the neighborhood of the current solution will be parallelized using [OpenMP](https://www.openmp.org).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `is_enabled_binary_move`                  |                       `bool`                       |               `true`                | If this option is set `true`, neighborhood moves that flip binary variables are enabled.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `is_enabled_integer_move`                 |                       `bool`                       |               `true`                | If this option is set `true`, neighborhood moves that increment or decrement integer variables are enabled.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `is_enabled_aggregation_move`             |                       `bool`                       |               `false`               | If this option is set `true`, neighborhood moves specialized for [aggregation constraints](https://miplib.zib.de/statistics.html) are enabled.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `is_enabled_precedence_move`              |                       `bool`                       |               `false`               | If this option is set `true`, neighborhood moves specialized for [precedence constraints](https://miplib.zib.de/statistics.html) are enabled.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `is_enabled_variable_bound_move`          |                       `bool`                       |               `false`               | If this option is set `true`, neighborhood moves specialized for [variable bound](https://miplib.zib.de/statistics.html) are enabled.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `is_enabled_exclusive_move`               |                       `bool`                       |               `false`               | If this option is set `true`, neighborhood moves specialized for [set partitioning and set covering](https://miplib.zib.de/statistics.html) are enabled. An exclusive neighborhood turns the value of a decision variable to 1 while turning the value of other decision variables in the set partitioning or set covering constraint which the selected variable is includes, to 0.                                                                                                                                                                                                                                                                                                                                                                                                            |
| `is_enabled_chain_move`                   |                       `bool`                       |               `false`               | If this option is set `true`, two or more moves will be combined adaptively.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `selection_mode`                          |        `SelectionMode`<br/>(`cppmh::model`)        |               `None`                | Rule to detect and extract selection constraints. <br/> `None`: No selection constraints will be extracted. <br /> `Defined`: If a decision variable is included in more than one selection constraints, the selection constraint defined at first will extracted in priority. <br /> `Smaller`: If a decision variable is included in more than one selection constraints, the selection constraint with the smaller number of decision variables will extracted in priority. <br /> `Larger`: If a decision variable is included in more than one selection constraints, the selection constraint with the larger number of decision variables will extracted in priority. <br /> `Independent` Selection constraints that do not share decision variables with each other will be extracted. |
| `improvability_screening_mode`            | `ImprovabilityScreeningMode`<br/>(`cppmh::solver`) |             `Automatic`             | Rule for screening neighborhood moves.<br/> `Off`: No screening. <br/> `Soft`: Only moves with improvement in objective function or constraint violation will be selected. <br/> `Aggressive`: If the current solution is infeasible, only moves with improvement in constraint violation will be selected. <br /> `Automatic`: Depending on the search situation, either `Soft` or `Aggressive` screening will be automatically applied.                                                                                                                                                                                                                                                                                                                                                       |
| `target_objective`                        |                      `double`                      | `1E100` <br/>or `-1E100` <br/> or 0 | Target objective function value. If the objective the function of the feasible incumbent reaches `target_objective` , optimization calculation will be terminated. For minimization problems and maximization problems, `-1E100` and `1E100` will be set as default values, respectively. If the objective function is not defined, the target will be set 0 and the optimization will be terminated if a feasible solution is found.                                                                                                                                                                                                                                                                                                                                                           |
| `seed`                                    |                       `int`                        |                 `1`                 | Random seed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `verbose`                                 |         `Verbose` <br />(`cppmh::Solver`)          |               `None`                | Log level of standard output. <br /> `None`: No output. <br /> `Warn`: Output only warning messages. <br /> `Outer`: Output warning messages and outer loop intermediate results. <br /> `Full`: Output full information.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

### Lagrange Dual Search Options
| Name                                         |   Type   | Default | Description                                                                                                                                                                                                                          |
|:---------------------------------------------|:--------:|:-------:|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `lagrange_dual`<br/>`.iteration_max`         |  `int`   | `10000` | Allowed maximum number of the lagrange dual search loop iterations.                                                                                                                                                                  |
| `lagrange_dual`<br/>`.time_max`              | `double` |  `120`  | Allowed maximum computational time for lagrange dual search.                                                                                                                                                                         |
| `lagrange_dual`<br/>`.step_size_extend_rate` | `double` | `1.05`  | If it is determined that the step size is too small, the subgradient algorithm will extend the step size according to the value of this option. Larger value accelerates the convergence speed but it may also affect the stability. |
| `lagrange_dual`<br/>`.step_size_reduce_rate` | `double` | `0.95`  | If it is determined that the step size is too large, the subgradient algorithm will reduce the step size according to the value of this option.                                                                                      |
| `lagrange_dual`<br/>`.tolerance`             | `double` | `1E-5`  | The tolerance for determining convergence of the subgradient algorithm. It should be specified as a ratio to the absolute value of the Lagrangian.                                                                                   |
| `lagrange_dual`<br/>`.queue_size`            |  `int`   |  `100`  | The maximum size of queue which contains the value of Lagrangian for determining convergence.                                                                                                                                        |
| `lagrange_dual`<br/>`.log_interval`          |  `int`   |  `10`   | Iteration interval to print the calculation log to standard output. This option is effective only if `verbose` is set `Full`.                                                                                                        |


### Local Search Options
| Name                                |   Type   | Default | Description                                                                                                                   |
|:------------------------------------|:--------:|:-------:|:------------------------------------------------------------------------------------------------------------------------------|
| `local_search`<br/>`.iteration_max` |  `int`   | `10000` | Allowed maximum number of the local search loop iterations.                                                                   |
| `local_search`<br/>`.time_max`      | `double` |  `120`  | Allowed maximum computational time for local search.                                                                          |
| `local_search`<br/>`.log_interval`  |  `int`   |  `10`   | Iteration interval to print the calculation log to standard output. This option is effective only if `verbose` is set `Full`. |
| `local_search`<br/>`.seed`          |  `int`   |   `1`   | Random seed.                                                                                                                  |


### Tabu Search Options
| Name                                                             |               Type               | Default | Description                                                                                                                                                                                                                                                                                                                                                                    |
|:-----------------------------------------------------------------|:--------------------------------:|:-------:|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `tabu_search`<br/>`.iteration_max`                               |              `int`               |  `200`  | Allowed maximum number of one tabu search loop iterations.                                                                                                                                                                                                                                                                                                                     |
| `tabu_search`<br/>`.time_max`                                    |             `double`             |  `120`  | Allowed maximum computational time for one tabu search.                                                                                                                                                                                                                                                                                                                        |
| `tabu_search`<br/>`.log_interval`                                |              `int`               |  `10`   | Iteration interval to print the calculation log to standard output. This option is effective only if `verbose` is set `Full`.                                                                                                                                                                                                                                                  |
| `tabu_search`<br/>`.initial_tabu_tenure`                         |              `int`               |  `10`   | Initial tabu tenure. The value of a decision variable can not be changed again until the number of tabu tenure iterations has passed.                                                                                                                                                                                                                                          |
| `tabu_search`<br/>`.tabu_tenure_randomize_rate`                  |             `double`             |  `0.5`  | Tabu tenure for each move will be randomized according to the value of this option. The value should be specified as the rate to the tabu tenure. For example, if the nominal tabu tenure is internally set `20` and `tabu_tenure_randomize_rate` is set `0.5`, the actual tabu tenure for each move will be set randomly in the range [10, 30].                               |
| `tabu_search`<br/>`.tabu_mode`                                   | `TabuMode`<br/>(`cppmh::solver`) |  `All`  | Rule to determine the acceptability (tabu or not) of a move from the current solution to a neighborhood solution for the case that the move consists of multiple variable changes.   <br/> `All`: The move is not acceptable if all of the variables included in the move are "tabu". <br /> `Any`: The move is not acceptable if any variable includes in the move is "tabu". |
| `tabu_search`<br/>`.move_preserve_rate`                          |             `double`             |  `1.0`  | Preserve rate of moves when the number of moves will be curtailed. The option is effective only if `is_enabled_move_curtail` is set `true`.                                                                                                                                                                                                                                    |
| `tabu_search`<br/>`.frequency_penalty_coefficient`               |             `double`             | `1E-5`  | Coefficient to penalize moves which change frequently updated variables.                                                                                                                                                                                                                                                                                                       |
| `tabu_search`<br/>`.is_enabled_shuffle`                          |              `bool`              | `true`  | If this option is set `true`, the evaluation order of neighbor solutions will be shuffled. Typically, this option is used with `move_preserve_rate` and `is_enabled_move_curtail`.                                                                                                                                                                                             |
| `tabu_search`<br/>`.is_enabled_move_curtail`                     |              `bool`              | `false` | If this option is set `true`, the number of evaluations of neighborhood solutions will be reduced by the value of 1 - `move_preserve_rate`.                                                                                                                                                                                                                                    |
| `tabu_search`<br/>`.is_enabled_automatic_break`                  |              `bool`              | `true`  | If this option is set `true`, a tabu search loop will be terminated automatically if the penalty coefficients are not appropriate.                                                                                                                                                                                                                                             |
| `tabu_search`<br/>`.is_enabled_automatic_tabu_tenure_adjustment` |              `bool`              | `true`  | If this option is set `true`, the tabu tenure will be adjusted automatically based on the update frequency of decision variables.                                                                                                                                                                                                                                              |
| `tabu_search`<br/>`.is_enabled_automatic_iteration_adjustment`   |              `bool`              | `true`  | If this option is set `true`, the allowed maximum number of iteration will be adjusted automatically based on the incumbent updating history.                                                                                                                                                                                                                                  |
| `tabu_search`<br/>`.is_enabled_initial_modification`             |              `bool`              | `true`  | If this option is set `true`, the initial solution in each tabu search loop will be modified randomly if the previous loop has failed to update the incumbent.                                                                                                                                                                                                                 |
| `tabu_search`<br/>`.ignore_tabu_if_augmented_incumbent`          |              `bool`              | `false` | If this option is set `true`, an unaccepted move will be specially adopted if the move updates augmented incumbent.                                                                                                                                                                                                                                                            |
| `tabu_search`<br/>`.ignore_tabu_if_feasible_incumbent`           |              `bool`              | `true`  | If this option is set `true`, an unaccepted move will be specially adopted if the move updates feasible incumbent.                                                                                                                                                                                                                                                             |
| `tabu_search`<br/>`.seed`                                        |              `int`               |   `1`   | Random seed.                                                                                                                                                                                                                                                                                                                                                                   |

